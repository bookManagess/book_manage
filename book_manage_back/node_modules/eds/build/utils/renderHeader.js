const path = require('path');
const cheerio = require('cheerio');
const _ = require('lodash');

module.exports = function renderHeader(file, versions, i18next) {
  const html = file.contents.toString();
  const $ = cheerio.load(html);
  const $chooseVersions = $('#chooseVersions').find('.dropdown-menu');
  const $chooseLangs = $('#chooseLangs').find('.dropdown-menu');
  const version = path.dirname(file.path).split(path.sep).pop();

  let versionHTML = '';
  _.forEach(versions, function(version) {
    versionHTML += `<li><a href="/${version}">${version}</a></li>`;
  });
  $chooseVersions.html(versionHTML);

  let langHTML = '';
  _.forIn(i18next[version].i18next, function(value, lang) {
    langHTML += `<li><a href="?lang=${lang}" data-lang="${lang}" class="js-changeLang">${value}</a></li>`;
  });
  $chooseLangs.html(langHTML);

  return $.html();
}